<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>脱獄チャンス</title>
  <style>
    :root{
      --bg:#0b0f1c;
      --card:#171b2c;
      --accent:#38bdf8;
      --accent-2:#a78bfa;
      --ok:#22c55e;
      --ng:#ef4444;
      --text:#e5e7eb;
      --muted:#a8b0c3;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans JP", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
      color:var(--text);
      overflow:hidden;
    }
    /* 背景など（省略なし） */
    .bg{position:fixed;inset:0;z-index:-3;
      background: radial-gradient(1200px 800px at 20% -10%, rgba(56,189,248,.18), transparent 60%),
                  radial-gradient(1200px 800px at 120% 110%, rgba(167,139,250,.16), transparent 60%),
                  linear-gradient(120deg, #0b0f1c, #11173a 40%, #1a1140 80%, #0b0f1c);
      background-size: 120% 120%;
      animation: bg-pan 30s linear infinite;}
    @keyframes bg-pan{0%{background-position:0 0}50%{background-position:100% 100%}100%{background-position:0 0}}
    .stars,.stars2{position:fixed;inset:-20%;z-index:-2;pointer-events:none;
      background-image:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.35) 50%, transparent 51%),
        radial-gradient(2px 2px at 40% 60%, rgba(255,255,255,.3) 50%, transparent 51%),
        radial-gradient(2px 2px at 60% 20%, rgba(255,255,255,.28) 50%, transparent 51%),
        radial-gradient(1.5px 1.5px at 80% 50%, rgba(255,255,255,.25) 50%, transparent 51%),
        radial-gradient(1.5px 1.5px at 30% 80%, rgba(255,255,255,.22) 50%, transparent 51%);
      animation: drift 80s linear infinite;opacity:.6;}
    .stars2{animation-duration:120s;opacity:.4;filter:blur(.3px);}
    @keyframes drift{0%{transform:translate3d(0,0,0)}50%{transform:translate3d(-5%,-4%,0)}100%{transform:translate3d(0,0,0)}}
    .bars{position:fixed;inset:-10%;z-index:-1;pointer-events:none;
      background:repeating-linear-gradient(90deg,rgba(255,255,255,.03) 0 6px,transparent 6px 64px);
      animation: bars-move 10s linear infinite;mix-blend-mode:screen;}
    @keyframes bars-move{0%{transform:translateX(0)}100%{transform:translateX(-64px)}}

    .wrap{min-height:100%;display:grid;place-items:center;padding:24px;}
    .card{width:min(760px,92vw);background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02)),var(--card);
      border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);padding:32px 28px;
      box-shadow:var(--shadow);text-align:center;position:relative;overflow:hidden;}
    h1{font-size:clamp(28px,4.8vw,44px);letter-spacing:.06em;margin:6px 0 18px;
      background:linear-gradient(90deg,var(--accent),var(--accent-2));-webkit-background-clip:text;
      background-clip:text;color:transparent;text-shadow:0 0 20px rgba(56,189,248,.25);}
    p.lead{margin:0 0 18px;color:var(--muted);font-size:clamp(14px,2.6vw,16px);}
    .btn{appearance:none;border:none;border-radius:14px;padding:14px 22px;font-weight:700;font-size:18px;cursor:pointer;
      color:#0b1220;background:linear-gradient(90deg,var(--accent),var(--accent-2));
      box-shadow:0 10px 22px rgba(56,189,248,.25),inset 0 0 0 1px rgba(255,255,255,.25);transition:.2s;}
    .btn:hover{filter:brightness(1.05)}.btn:active{transform:translateY(1px) scale(.99)}
    .btn.secondary{background:#2b3046;color:var(--text);box-shadow:inset 0 0 0 1px rgba(255,255,255,.08);}
    .hidden{display:none!important}
    .count-wrap{margin:18px 0 8px;display:flex;align-items:center;justify-content:center;gap:16px;flex-wrap:wrap;}
    .count-num{font-variant-numeric:tabular-nums;font-size:clamp(40px,10vw,96px);font-weight:900;animation:pulse 1.4s infinite;}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
    .ticker{width:clamp(220px,60vw,520px);height:10px;background:rgba(255,255,255,.06);border-radius:999px;overflow:hidden;}
    .bar{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width .2s linear;}
    .result{font-weight:900;font-size:clamp(36px,7.5vw,84px);margin:8px 0 16px;}
    .success{color:var(--ok);} .fail{color:var(--ng);}
    .flash{position:fixed;inset:0;background:rgba(239,68,68,.25);animation:fade .45s ease forwards;z-index:10;}
    @keyframes fade{to{opacity:0}}
  </style>
</head>
<body>
  <div class="bg"></div><div class="stars"></div><div class="stars2"></div><div class="bars"></div>
  <div class="wrap">
    <main class="card" id="card">
      <section id="screen-title">
        <h1>脱獄チャンス</h1>
        <p class="lead">スタートを押すとカウントダウン開始。ゼロになったら、<strong>1/10</strong>で「脱獄成功」！</p>
        <button id="startBtn" class="btn">スタート</button>
      </section>
      <section id="screen-game" class="hidden">
        <h1>脱獄成功まで....</h1>
        <div class="count-wrap"><div id="countNum" class="count-num">3</div><div class="ticker"><div id="bar" class="bar"></div></div></div>
      </section>
      <section id="screen-result" class="hidden">
        <div id="resultText" class="result">結果</div>
        <button id="retryBtn" class="btn secondary">もう一度</button>
      </section>
    </main>
  </div>

  <script>
    const COUNTDOWN_SECONDS = 3; // ←★ここを3秒に変更★

    const screenTitle=document.getElementById('screen-title');
    const screenGame=document.getElementById('screen-game');
    const screenResult=document.getElementById('screen-result');
    const startBtn=document.getElementById('startBtn');
    const retryBtn=document.getElementById('retryBtn');
    const countNum=document.getElementById('countNum');
    const bar=document.getElementById('bar');
    const resultText=document.getElementById('resultText');
    const card=document.getElementById('card');
    let remaining=COUNTDOWN_SECONDS,timerId=null,startedAt=null;

    function show(el){
      for(const s of [screenTitle,screenGame,screenResult]) s.classList.toggle('hidden',s!==el);
    }
    function reset(){
      clearInterval(timerId);
      remaining=COUNTDOWN_SECONDS;
      countNum.textContent=remaining;
      bar.style.width='0%';
      resultText.textContent='';
    }
    function start(){
      reset();show(screenGame);
      startedAt=performance.now();
      const totalMs=COUNTDOWN_SECONDS*1000;
      timerId=setInterval(()=>{
        const elapsed=performance.now()-startedAt;
        const leftMs=Math.max(0,totalMs-elapsed);
        const newRem=Math.ceil(leftMs/1000);
        if(newRem!==remaining){remaining=newRem;countNum.textContent=remaining;}
        bar.style.width=Math.min(100,elapsed/totalMs*100)+'%';
        if(leftMs<=0){clearInterval(timerId);countNum.textContent='0';bar.style.width='100%';decide();}
      },50);
    }
    function redFlash(){
      const f=document.createElement('div');
      f.className='flash';
      document.body.appendChild(f);
      setTimeout(()=>f.remove(),500);
    }
    function decide(){
      const success=Math.random()<0.1;
      resultText.textContent=success?'脱獄成功！！':'脱獄失敗…';
      resultText.classList.add(success?'success':'fail');
      show(screenResult);
      if(!success)redFlash();
    }
    startBtn.onclick=start;
    retryBtn.onclick=()=>show(screenTitle);
  </script>
</body>
</html>
